{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport config from \"../../config/index.js\";\nimport router from \"../../router/index\";\nconst authModules = {\n  state: {\n    isLogin: false,\n    rule: \"\"\n  },\n  getters: {\n    getIsLogin(state) {\n      return state.isLogin;\n    },\n\n    getRule(state) {\n      return state.rule;\n    }\n\n  },\n  mutations: {\n    LOGOUT(state) {\n      state.isLogin = false;\n    },\n\n    LOGIN(state) {\n      state.isLogin = true;\n    },\n\n    SET_RULE(state, newRule) {\n      state.rule = newRule;\n    }\n\n  },\n  actions: {\n    logout({\n      commit\n    }) {\n      localStorage.clear();\n      commit(\"LOGOUT\");\n    },\n\n    async login({\n      commit\n    }, account) {\n      const response = await axios.post(`${config.domain}/login`, {\n        username: account.username,\n        password: account.password\n      });\n      const rule = response.data.rule;\n      const accessToken = response.data.accessToken;\n      const accountInfor = response.data.accountInfor;\n\n      if (response.data.accessToken) {\n        localStorage.setItem(\"token\", accessToken);\n        localStorage.setItem(\"rule\", rule); // handle next page\n\n        if (rule == \"ADMIN\") {\n          router.push(\"/admin/home\");\n        } else if (rule == \"STUDENT\") router.push(\"/student/home\");else if (rule == \"TEACHER\") router.push(\"/teacher/home\");else if (rule == \"MINISTRY\") router.push(\"/ministry/home\");else if (rule == \"COMPANY\") router.push(\"/company/home\");\n\n        commit(\"LOGIN\"); // Save account login to store account\n\n        commit(\"SET_ACCOUNT\", accountInfor);\n      } // Hien thi thong bao\n\n\n      commit(\"SET_TOAST\", {\n        isSuccess: response.data.status,\n        message: response.data.message\n      });\n    },\n\n    async setRule({\n      commit\n    }) {\n      const token = localStorage.getItem(\"token\");\n      const res = await axios.post(`${config.domain}/get-rule`, {}, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const rule = res.data.rule;\n      commit(\"SET_RULE\", rule);\n    }\n\n  }\n};\nexport default authModules;","map":{"version":3,"names":["axios","config","router","authModules","state","isLogin","rule","getters","getIsLogin","getRule","mutations","LOGOUT","LOGIN","SET_RULE","newRule","actions","logout","commit","localStorage","clear","login","account","response","post","domain","username","password","data","accessToken","accountInfor","setItem","push","isSuccess","status","message","setRule","token","getItem","res","headers","Authorization"],"sources":["D:/KTPM/Final_NienLuan/internship-management/frontend/src/store/modules/authModule.js"],"sourcesContent":["import axios from \"axios\";\r\nimport config from \"../../config/index.js\";\r\nimport router from \"../../router/index\";\r\nconst authModules = {\r\n    state: {\r\n        isLogin: false,\r\n        rule: \"\",\r\n    },\r\n    getters: {\r\n        getIsLogin(state) {\r\n            return state.isLogin;\r\n        },\r\n        getRule(state) {\r\n            return state.rule;\r\n        },\r\n    },\r\n\r\n    mutations: {\r\n        LOGOUT(state) {\r\n            state.isLogin = false;\r\n        },\r\n        LOGIN(state) {\r\n            state.isLogin = true;\r\n        },\r\n        SET_RULE(state, newRule) {\r\n            state.rule = newRule;\r\n        },\r\n    },\r\n    actions: {\r\n        logout({ commit }) {\r\n            localStorage.clear();\r\n            commit(\"LOGOUT\");\r\n        },\r\n        async login({ commit }, account) {\r\n            const response = await axios.post(`${config.domain}/login`, {\r\n                username: account.username,\r\n                password: account.password,\r\n            });\r\n\r\n            const rule = response.data.rule;\r\n            const accessToken = response.data.accessToken;\r\n            const accountInfor = response.data.accountInfor;\r\n\r\n            if (response.data.accessToken) {\r\n                localStorage.setItem(\"token\", accessToken);\r\n                localStorage.setItem(\"rule\", rule);\r\n                // handle next page\r\n\r\n                if (rule == \"ADMIN\") {\r\n                    router.push(\"/admin/home\");\r\n                } else if (rule == \"STUDENT\") router.push(\"/student/home\");\r\n                else if (rule == \"TEACHER\") router.push(\"/teacher/home\");\r\n                else if (rule == \"MINISTRY\") router.push(\"/ministry/home\");\r\n                else if (rule == \"COMPANY\") router.push(\"/company/home\");\r\n\r\n                commit(\"LOGIN\");\r\n                // Save account login to store account\r\n                commit(\"SET_ACCOUNT\", accountInfor);\r\n            }\r\n\r\n            // Hien thi thong bao\r\n            commit(\"SET_TOAST\", {\r\n                isSuccess: response.data.status,\r\n                message: response.data.message,\r\n            });\r\n        },\r\n        async setRule({ commit }) {\r\n            const token = localStorage.getItem(\"token\");\r\n\r\n            const res = await axios.post(\r\n                `${config.domain}/get-rule`,\r\n                {},\r\n                {\r\n                    headers: {\r\n                        Authorization: `Bearer ${token}`,\r\n                    },\r\n                }\r\n            );\r\n\r\n            const rule = res.data.rule;\r\n\r\n            commit(\"SET_RULE\", rule);\r\n        },\r\n    },\r\n};\r\n\r\nexport default authModules;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}